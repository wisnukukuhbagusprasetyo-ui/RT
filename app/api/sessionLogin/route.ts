import { NextResponse } from 'next/server';import { adminAuth } from '@/lib/firebaseAdmin';
export async function POST(req:Request){try{const {idToken}=await req.json();if(!idToken)return NextResponse.json({error:'Missing idToken'},{status:400});const days=Number(process.env.SESSION_COOKIE_MAX_DAYS||5);const expiresIn=days*24*60*60*1000;const sessionCookie=await adminAuth.createSessionCookie(idToken,{expiresIn});const res=NextResponse.json({ok:true});res.cookies.set(process.env.SESSION_COOKIE_NAME||'rt_session',sessionCookie,{httpOnly:true,secure:process.env.SESSION_COOKIE_SECURE==='true',maxAge:expiresIn/1000,sameSite:'lax',path:'/'});return res;}catch(e){return NextResponse.json({error:'Failed to create session'},{status:400});}}